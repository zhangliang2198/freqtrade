# LLM 提示词风格配置说明

本系统支持三种提示词风格，可在 `llm_deepseek.json` 配置文件中通过 `prompt_style` 参数进行切换。

## 配置方式

在 `user_data/llm_deepseek.json` 文件中设置 `prompt_style` 参数：

```json
{
    "llm_config": {
        "prompt_style": "conservative",
        ...
    }
}
```

## 可用风格

### 1. `"default"` - 默认风格

使用原始的提示词模板（无后缀），适合平衡型交易者。

**文件命名**: `entry.j2`, `exit.j2`, `stake.j2`, `adjust.j2`, `leverage.j2`

**特点**:
- 平衡风险与收益
- 适中的入场标准
- 标准的仓位管理
- 适合大多数交易场景

---

### 2. `"conservative"` - 保守风格

**文件命名**: `entry_conservative.j2`, `exit_conservative.j2`, `stake_conservative.j2`, `adjust_conservative.j2`, `leverage_conservative.j2`

**核心理念**: **保本优先于盈利，宁可错过100次机会，也不做错1次交易**

#### 入场策略 (entry_conservative.j2)
- ✅ **严格入场条件**: 至少3个以上技术指标共振
- ✅ **风险控制优先**: 资金使用率>60%禁止开仓
- ✅ **持仓限制**: 同一交易对≥2个持仓禁止开仓
- ✅ **风险回报比**: 必须≥3:1
- ✅ **置信度标准**: 低于0.5必须选择hold

#### 出场策略 (exit_conservative.j2)
- ✅ **快速止损**: 亏损超过-3%严格评估，技术破位立即止损
- ✅ **及时止盈**: 盈利≥5%考虑止盈，回撤>30%强烈建议止盈
- ✅ **见好就收**: 落袋为安，不让盈利变亏损

#### 仓位管理 (stake_conservative.j2)
- ✅ **小仓位**: 倍数范围0.5x-1.2x，最大不超过1.2x
- ✅ **严格资金控制**: 资金使用率>50%强制减半，>60%禁止开仓
- ✅ **持仓分散**: 同一交易对已有持仓强制减半

#### 仓位调整 (adjust_conservative.j2)
- ✅ **禁止逆势加仓**: PnL<0%时严禁加仓
- ✅ **积极做T减仓**: 盈利时优先部分止盈
- ✅ **调整幅度**: 加仓最大0.3，减仓最大-0.5

#### 杠杆管理 (leverage_conservative.j2)
- ✅ **低杠杆**: 建议范围1.0x-2.0x，最大不超过3.0x
- ✅ **清算保护**: 清算距离必须>15%
- ✅ **高波动禁杠杆**: 波动率>3%禁止杠杆

**适合人群**:
- 风险厌恶型交易者
- 新手交易者
- 追求稳定收益的交易者
- 小资金账户

---

### 3. `"aggressive"` - 激进风格

**文件命名**: `entry_aggressive.j2`, `exit_aggressive.j2`, `stake_aggressive.j2`, `adjust_aggressive.j2`, `leverage_aggressive.j2`

**核心理念**: **积极捕捉机会，追求高收益，在风险可控前提下最大化收益潜力**

#### 入场策略 (entry_aggressive.j2)
- ⚡ **降低入场门槛**: 2个以上技术指标共振即可入场
- ⚡ **资金充分利用**: 资金使用率<80%可继续开仓
- ⚡ **允许试错**: 信号不够完美时可小仓位试探
- ⚡ **风险回报比**: ≥2:1即可
- ⚡ **置信度标准**: 0.3以上即可考虑入场

#### 出场策略 (exit_aggressive.j2)
- ⚡ **让利润奔跑**: 趋势延续时大胆持有，即使盈利20%+也可继续
- ⚡ **容忍回撤**: 盈利回撤50%以内视为正常
- ⚡ **动态止盈**: 盈利≥8-10%+强阻力才考虑止盈
- ⚡ **快速止损**: 亏损超过-5%无技术支撑立即止损

#### 仓位管理 (stake_aggressive.j2)
- ⚡ **大仓位**: 倍数范围0.8x-3.0x
- ⚡ **信号强放大**: 极强信号可用2.0-3.0x
- ⚡ **充分利用资金**: 资金使用率<60%可充分放大仓位

#### 仓位调整 (adjust_aggressive.j2)
- ⚡ **积极做T**: 调整幅度-0.6至0.6
- ⚡ **允许逆势加仓**: 小亏损(-2%至-5%)+强技术支撑可加仓摊低成本
- ⚡ **大胆加仓**: 技术支撑时可加仓0.4-0.6

#### 杠杆管理 (leverage_aggressive.j2)
- ⚡ **高杠杆**: 常用范围3.0x-10.0x
- ⚡ **信号强用高杠杆**: 极强信号可用8.0-10.0x
- ⚡ **清算保护**: 清算距离>10%即可（容忍更高风险）

**适合人群**:
- 风险偏好型交易者
- 经验丰富的交易者
- 追求高收益的交易者
- 大资金账户
- 能承受较大回撤的交易者

---

## 切换风格

只需修改配置文件中的 `prompt_style` 参数，系统会自动加载对应的提示词模板：

```json
// 使用保守风格
"prompt_style": "conservative"

// 使用激进风格
"prompt_style": "aggressive"

// 使用默认风格
"prompt_style": "default"
```

**注意**: 修改配置后需要重启 Freqtrade 才能生效。

---

## 风格对比表

| 特性 | 保守风格 | 默认风格 | 激进风格 |
|------|---------|---------|---------|
| **入场门槛** | 3个以上指标共振 | 2-3个指标 | 2个指标即可 |
| **资金使用率限制** | >60%禁止开仓 | >80%禁止开仓 | >90%禁止开仓 |
| **仓位倍数** | 0.5x-1.2x | 0.5x-2.0x | 0.8x-3.0x |
| **杠杆范围** | 1.0x-2.0x (最大3.0x) | 1.0x-5.0x | 2.0x-10.0x |
| **止损标准** | -3% | -5% | -5% |
| **止盈策略** | ≥5%考虑止盈 | ≥7%考虑止盈 | ≥8-10%考虑止盈 |
| **盈利回撤容忍** | 30% | 40% | 50% |
| **逆势加仓** | 严禁 | 不推荐 | 允许（小亏损+强支撑） |
| **调整幅度** | -0.5至0.3 | -0.5至0.5 | -0.6至0.6 |
| **风险回报比** | ≥3:1 | ≥2.5:1 | ≥2:1 |
| **清算距离要求** | >15% | >12% | >10% |

---

## 建议

1. **新手**: 建议从 `conservative` 开始，熟悉后再考虑切换
2. **测试**: 在回测模式下测试不同风格的表现
3. **市场适应**: 根据市场环境动态调整风格
   - 高波动市场: 使用 `conservative`
   - 正常市场: 使用 `default`
   - 低波动趋势市场: 考虑 `aggressive`
4. **资金规模**: 小资金建议 `conservative`，大资金可考虑 `aggressive`
5. **风险承受**: 根据个人风险承受能力选择合适风格

---

## 技术实现

系统会根据 `prompt_style` 配置自动选择对应的模板文件：

- `prompt_style: "conservative"` → 使用 `*_conservative.j2` 模板
- `prompt_style: "aggressive"` → 使用 `*_aggressive.j2` 模板
- `prompt_style: "default"` → 使用 `*.j2` 模板（无后缀）

如果找不到对应风格的模板，系统会自动回退到默认模板（无后缀）。

---

**警告**: 激进风格虽然追求高收益，但也伴随更高的风险。请根据自己的风险承受能力谨慎选择，并始终设置合理的止损保护。
